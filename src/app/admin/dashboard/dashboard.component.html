<div class="dashboard-container">
  <app-admin-sidebar [currentPage]="currentPage"></app-admin-sidebar>

  <!-- Main Content -->
  <main class="dashboard-main">
    <!-- Header -->
    <header class="dashboard-header">
      <div>
        <h1 class="header-title">Welcome back, Admin</h1>
        <p class="header-subtitle">Here's what's happening with your care services</p>
      </div>
      <div class="header-user">
        <div class="user-avatar">
          <img *ngIf="profileImage" [src]="profileImage" alt="Profile" style="width:100%;height:100%;object-fit:cover;border-radius:inherit;">
          <span *ngIf="!profileImage">A</span>
        </div>
        <div class="user-info">
          <p class="user-name">{{ adminEmail }}</p>
          <p class="user-role">{{ adminRole }}</p>
        </div>
      </div>
    </header>

    <!-- Content Area -->
    <div class="dashboard-content">
      <!-- Overview Stats -->
      <div class="stats-grid">
        <div class="stat-card" *ngFor="let stat of stats">
          <div class="stat-icon" [style.background-color]="stat.color + '15'">
            <svg *ngIf="stat.icon === 'users'" [attr.stroke]="stat.color" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <svg *ngIf="stat.icon === 'briefcase'" [attr.stroke]="stat.color" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2">
              <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
              <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
            </svg>
            <svg *ngIf="stat.icon === 'eye'" [attr.stroke]="stat.color" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            <svg *ngIf="stat.icon === 'activity'" [attr.stroke]="stat.color" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
          </div>
          <div class="stat-content">
            <p class="stat-title">{{ stat.title }}</p>
            <div class="stat-value-row">
              <h3 class="stat-value">{{ stat.value }}</h3>
              <span class="stat-change" [class.positive]="stat.trend === 'up'">{{ stat.change }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Analytics Section with Graphs -->
      <div class="analytics-section">
        <div class="section-header">
          <div>
            <h2 class="section-title">Site Analytics</h2>
            <p class="section-subtitle">Performance overview for the last 7 days</p>
          </div>
          <button class="view-all-button" (click)="viewAnalytics()">View Full Analytics</button>
        </div>

        <div class="analytics-grid">
          <!-- Traffic Sources Pie Chart -->
          <div class="chart-card">
            <h3 class="chart-title">Traffic Sources</h3>
            <div class="traffic-chart">
              <div class="pie-chart"></div>
              <div class="traffic-legend">
                <div class="legend-item" *ngFor="let source of trafficSources">
                  <div class="legend-dot" [style.background]="source.color"></div>
                  <div class="legend-text">
                    <span class="legend-label">{{ source.source }}</span>
                    <span class="legend-value">{{ source.visitors.toLocaleString() }} ({{ source.percentage }}%)</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Device Breakdown -->
          <div class="chart-card">
            <h3 class="chart-title">Device Breakdown</h3>
            <div class="device-chart">
              <div class="device-bar" *ngFor="let device of devices">
                <div class="device-info">
                  <span class="device-name">{{ device.name }}</span>
                  <span class="device-percentage">{{ device.percentage }}%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" [style.width.%]="device.percentage" [style.background]="device.color"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Applications -->
      <div class="applications-section">
        <div class="section-header">
          <h2 class="section-title">Recent Applications</h2>
          <button class="view-all-button" (click)="viewAllApplications()">View All</button>
        </div>

        <div class="applications-table">
          <table>
            <thead>
              <tr>
                <th>Applicant Name</th>
                <th>Position</th>
                <th>Applied</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let application of recentApplications">
                <td>
                  <div class="applicant-cell">
                    <div class="applicant-avatar">{{ application.name.charAt(0) }}</div>
                    <span>{{ application.name }}</span>
                  </div>
                </td>
                <td>{{ application.position }}</td>
                <td>{{ application.date }}</td>
                <td>
                  <span class="status-badge" [class.new]="application.status === 'New'" [class.reviewed]="application.status === 'Reviewed'" [class.interview]="application.status === 'Interview'">
                    {{ application.status }}
                  </span>
                </td>
                <td>
                  <button class="action-button" (click)="viewApplication(application.id)">View</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
</div>